{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5f52d86a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:49.955286Z",
     "iopub.status.busy": "2025-09-14T12:19:49.954956Z",
     "iopub.status.idle": "2025-09-14T12:19:53.604951Z",
     "shell.execute_reply": "2025-09-14T12:19:53.603988Z"
    },
    "papermill": {
     "duration": 3.659336,
     "end_time": "2025-09-14T12:19:53.606856",
     "exception": false,
     "start_time": "2025-09-14T12:19:49.947520",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd \n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "4cc64730",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:53.619696Z",
     "iopub.status.busy": "2025-09-14T12:19:53.619206Z",
     "iopub.status.idle": "2025-09-14T12:19:53.680276Z",
     "shell.execute_reply": "2025-09-14T12:19:53.679326Z"
    },
    "papermill": {
     "duration": 0.068982,
     "end_time": "2025-09-14T12:19:53.681810",
     "exception": false,
     "start_time": "2025-09-14T12:19:53.612828",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>season</th>\n",
       "      <th>city</th>\n",
       "      <th>date</th>\n",
       "      <th>match_type</th>\n",
       "      <th>player_of_match</th>\n",
       "      <th>venue</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>toss_winner</th>\n",
       "      <th>toss_decision</th>\n",
       "      <th>winner</th>\n",
       "      <th>result</th>\n",
       "      <th>result_margin</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>target_overs</th>\n",
       "      <th>super_over</th>\n",
       "      <th>method</th>\n",
       "      <th>umpire1</th>\n",
       "      <th>umpire2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>335982</td>\n",
       "      <td>2007/08</td>\n",
       "      <td>Bangalore</td>\n",
       "      <td>2008-04-18</td>\n",
       "      <td>League</td>\n",
       "      <td>BB McCullum</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>field</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>runs</td>\n",
       "      <td>140.0</td>\n",
       "      <td>223.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Asad Rauf</td>\n",
       "      <td>RE Koertzen</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>335983</td>\n",
       "      <td>2007/08</td>\n",
       "      <td>Chandigarh</td>\n",
       "      <td>2008-04-19</td>\n",
       "      <td>League</td>\n",
       "      <td>MEK Hussey</td>\n",
       "      <td>Punjab Cricket Association Stadium, Mohali</td>\n",
       "      <td>Kings XI Punjab</td>\n",
       "      <td>Chennai Super Kings</td>\n",
       "      <td>Chennai Super Kings</td>\n",
       "      <td>bat</td>\n",
       "      <td>Chennai Super Kings</td>\n",
       "      <td>runs</td>\n",
       "      <td>33.0</td>\n",
       "      <td>241.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MR Benson</td>\n",
       "      <td>SL Shastri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>335984</td>\n",
       "      <td>2007/08</td>\n",
       "      <td>Delhi</td>\n",
       "      <td>2008-04-19</td>\n",
       "      <td>League</td>\n",
       "      <td>MF Maharoof</td>\n",
       "      <td>Feroz Shah Kotla</td>\n",
       "      <td>Delhi Daredevils</td>\n",
       "      <td>Rajasthan Royals</td>\n",
       "      <td>Rajasthan Royals</td>\n",
       "      <td>bat</td>\n",
       "      <td>Delhi Daredevils</td>\n",
       "      <td>wickets</td>\n",
       "      <td>9.0</td>\n",
       "      <td>130.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aleem Dar</td>\n",
       "      <td>GA Pratapkumar</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       id   season        city        date match_type player_of_match  \\\n",
       "0  335982  2007/08   Bangalore  2008-04-18     League     BB McCullum   \n",
       "1  335983  2007/08  Chandigarh  2008-04-19     League      MEK Hussey   \n",
       "2  335984  2007/08       Delhi  2008-04-19     League     MF Maharoof   \n",
       "\n",
       "                                        venue                        team1  \\\n",
       "0                       M Chinnaswamy Stadium  Royal Challengers Bangalore   \n",
       "1  Punjab Cricket Association Stadium, Mohali              Kings XI Punjab   \n",
       "2                            Feroz Shah Kotla             Delhi Daredevils   \n",
       "\n",
       "                   team2                  toss_winner toss_decision  \\\n",
       "0  Kolkata Knight Riders  Royal Challengers Bangalore         field   \n",
       "1    Chennai Super Kings          Chennai Super Kings           bat   \n",
       "2       Rajasthan Royals             Rajasthan Royals           bat   \n",
       "\n",
       "                  winner   result  result_margin  target_runs  target_overs  \\\n",
       "0  Kolkata Knight Riders     runs          140.0        223.0          20.0   \n",
       "1    Chennai Super Kings     runs           33.0        241.0          20.0   \n",
       "2       Delhi Daredevils  wickets            9.0        130.0          20.0   \n",
       "\n",
       "  super_over method    umpire1         umpire2  \n",
       "0          N    NaN  Asad Rauf     RE Koertzen  \n",
       "1          N    NaN  MR Benson      SL Shastri  \n",
       "2          N    NaN  Aleem Dar  GA Pratapkumar  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1=pd.read_csv(\"/kaggle/input/ipl-complete-dataset-20082020/matches.csv\")\n",
    "df1.head(3)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3219689e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:53.695217Z",
     "iopub.status.busy": "2025-09-14T12:19:53.694285Z",
     "iopub.status.idle": "2025-09-14T12:19:54.654284Z",
     "shell.execute_reply": "2025-09-14T12:19:54.653347Z"
    },
    "papermill": {
     "duration": 0.968197,
     "end_time": "2025-09-14T12:19:54.655943",
     "exception": false,
     "start_time": "2025-09-14T12:19:53.687746",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>ball</th>\n",
       "      <th>batter</th>\n",
       "      <th>bowler</th>\n",
       "      <th>non_striker</th>\n",
       "      <th>batsman_runs</th>\n",
       "      <th>extra_runs</th>\n",
       "      <th>total_runs</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>335982</td>\n",
       "      <td>1</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>SC Ganguly</td>\n",
       "      <td>P Kumar</td>\n",
       "      <td>BB McCullum</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>legbyes</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>335982</td>\n",
       "      <td>1</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>BB McCullum</td>\n",
       "      <td>P Kumar</td>\n",
       "      <td>SC Ganguly</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>335982</td>\n",
       "      <td>1</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>BB McCullum</td>\n",
       "      <td>P Kumar</td>\n",
       "      <td>SC Ganguly</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>wides</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   match_id  inning           batting_team                 bowling_team  over  \\\n",
       "0    335982       1  Kolkata Knight Riders  Royal Challengers Bangalore     0   \n",
       "1    335982       1  Kolkata Knight Riders  Royal Challengers Bangalore     0   \n",
       "2    335982       1  Kolkata Knight Riders  Royal Challengers Bangalore     0   \n",
       "\n",
       "   ball       batter   bowler  non_striker  batsman_runs  extra_runs  \\\n",
       "0     1   SC Ganguly  P Kumar  BB McCullum             0           1   \n",
       "1     2  BB McCullum  P Kumar   SC Ganguly             0           0   \n",
       "2     3  BB McCullum  P Kumar   SC Ganguly             0           1   \n",
       "\n",
       "   total_runs extras_type  is_wicket player_dismissed dismissal_kind fielder  \n",
       "0           1     legbyes          0              NaN            NaN     NaN  \n",
       "1           0         NaN          0              NaN            NaN     NaN  \n",
       "2           1       wides          0              NaN            NaN     NaN  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df=pd.read_csv(\"/kaggle/input/ipl-complete-dataset-20082020/deliveries.csv\")\n",
    "df.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "def142a2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:54.670434Z",
     "iopub.status.busy": "2025-09-14T12:19:54.670081Z",
     "iopub.status.idle": "2025-09-14T12:19:54.992771Z",
     "shell.execute_reply": "2025-09-14T12:19:54.991813Z"
    },
    "papermill": {
     "duration": 0.33109,
     "end_time": "2025-09-14T12:19:54.994399",
     "exception": false,
     "start_time": "2025-09-14T12:19:54.663309",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>inning</th>\n",
       "      <th>total_runs</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>335982</td>\n",
       "      <td>1</td>\n",
       "      <td>222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>335982</td>\n",
       "      <td>2</td>\n",
       "      <td>82</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>335983</td>\n",
       "      <td>1</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>335983</td>\n",
       "      <td>2</td>\n",
       "      <td>207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>335984</td>\n",
       "      <td>1</td>\n",
       "      <td>129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2212</th>\n",
       "      <td>1426310</td>\n",
       "      <td>2</td>\n",
       "      <td>174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2213</th>\n",
       "      <td>1426311</td>\n",
       "      <td>1</td>\n",
       "      <td>175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2214</th>\n",
       "      <td>1426311</td>\n",
       "      <td>2</td>\n",
       "      <td>139</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2215</th>\n",
       "      <td>1426312</td>\n",
       "      <td>1</td>\n",
       "      <td>113</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2216</th>\n",
       "      <td>1426312</td>\n",
       "      <td>2</td>\n",
       "      <td>114</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2217 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      match_id  inning  total_runs\n",
       "0       335982       1         222\n",
       "1       335982       2          82\n",
       "2       335983       1         240\n",
       "3       335983       2         207\n",
       "4       335984       1         129\n",
       "...        ...     ...         ...\n",
       "2212   1426310       2         174\n",
       "2213   1426311       1         175\n",
       "2214   1426311       2         139\n",
       "2215   1426312       1         113\n",
       "2216   1426312       2         114\n",
       "\n",
       "[2217 rows x 3 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Total_runs_df=df.groupby([\"match_id\",'inning']).sum()['total_runs'].reset_index()\n",
    "Total_runs_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "b1edce1e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.009000Z",
     "iopub.status.busy": "2025-09-14T12:19:55.008401Z",
     "iopub.status.idle": "2025-09-14T12:19:55.018453Z",
     "shell.execute_reply": "2025-09-14T12:19:55.017372Z"
    },
    "papermill": {
     "duration": 0.019098,
     "end_time": "2025-09-14T12:19:55.019991",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.000893",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>inning</th>\n",
       "      <th>total_runs</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>335982</td>\n",
       "      <td>1</td>\n",
       "      <td>222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>335983</td>\n",
       "      <td>1</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>335984</td>\n",
       "      <td>1</td>\n",
       "      <td>129</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   match_id  inning  total_runs\n",
       "0    335982       1         222\n",
       "2    335983       1         240\n",
       "4    335984       1         129"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Total_runs_df=Total_runs_df[Total_runs_df['inning']==1] #only taking second inning\n",
    "Total_runs_df.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "963b80b2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.033713Z",
     "iopub.status.busy": "2025-09-14T12:19:55.033412Z",
     "iopub.status.idle": "2025-09-14T12:19:55.050190Z",
     "shell.execute_reply": "2025-09-14T12:19:55.049457Z"
    },
    "papermill": {
     "duration": 0.025486,
     "end_time": "2025-09-14T12:19:55.051877",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.026391",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1=df1.merge(Total_runs_df[[\"match_id\",\"total_runs\"]],left_on='id',right_on=\"match_id\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "9bbd01b3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.066249Z",
     "iopub.status.busy": "2025-09-14T12:19:55.065666Z",
     "iopub.status.idle": "2025-09-14T12:19:55.073075Z",
     "shell.execute_reply": "2025-09-14T12:19:55.072229Z"
    },
    "papermill": {
     "duration": 0.015621,
     "end_time": "2025-09-14T12:19:55.074449",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.058828",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Royal Challengers Bangalore', 'Kings XI Punjab',\n",
       "       'Delhi Daredevils', 'Mumbai Indians', 'Kolkata Knight Riders',\n",
       "       'Rajasthan Royals', 'Deccan Chargers', 'Chennai Super Kings',\n",
       "       'Kochi Tuskers Kerala', 'Pune Warriors', 'Sunrisers Hyderabad',\n",
       "       'Gujarat Lions', 'Rising Pune Supergiants',\n",
       "       'Rising Pune Supergiant', 'Delhi Capitals', 'Punjab Kings',\n",
       "       'Lucknow Super Giants', 'Gujarat Titans',\n",
       "       'Royal Challengers Bengaluru'], dtype=object)"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1['team1'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "4ff30401",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.088453Z",
     "iopub.status.busy": "2025-09-14T12:19:55.088099Z",
     "iopub.status.idle": "2025-09-14T12:19:55.092792Z",
     "shell.execute_reply": "2025-09-14T12:19:55.091950Z"
    },
    "papermill": {
     "duration": 0.013383,
     "end_time": "2025-09-14T12:19:55.094137",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.080754",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "teams = [\n",
    "    \"Chennai Super Kings\",\n",
    "    \"Mumbai Indians\",\n",
    "    \"Royal Challengers Bengaluru\",\n",
    "    \"Kolkata Knight Riders\",\n",
    "    \"Delhi Capitals\",\n",
    "    \"Rajasthan Royals\",\n",
    "    \"Sunrisers Hyderabad\",\n",
    "    \"Punjab Kings\",\n",
    "    \"Gujarat Titans\",\n",
    "    \"Lucknow Super Giants\"\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b7d798d4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.107950Z",
     "iopub.status.busy": "2025-09-14T12:19:55.107612Z",
     "iopub.status.idle": "2025-09-14T12:19:55.121651Z",
     "shell.execute_reply": "2025-09-14T12:19:55.120762Z"
    },
    "papermill": {
     "duration": 0.022723,
     "end_time": "2025-09-14T12:19:55.123077",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.100354",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1['team1']=df1['team1'].str.replace('Delhi Daredevils',\"Delhi Capitals\")\n",
    "df1['team2']=df1['team2'].str.replace('Delhi Daredevils',\"Delhi Capitals\")\n",
    "\n",
    "df1['team1']=df1['team1'].str.replace('Royal Challengers Bangalore',\"Royal Challengers Bengaluru\")\n",
    "df1['team2']=df1['team2'].str.replace('Royal Challengers Bangalore',\"Royal Challengers Bengaluru\")\n",
    "\n",
    "df1['team1']=df1['team1'].str.replace('Kings XI Punjab',\"Punjab Kings\")\n",
    "df1['team2']=df1['team2'].str.replace('Kings XI Punjab',\"Punjab Kings\")\n",
    "\n",
    "df1['team1']=df1['team1'].str.replace('Deccan Chargers',\"Sunrisers Hyderabad\")\n",
    "df1['team2']=df1['team2'].str.replace('Deccan Chargers',\"Sunrisers Hyderabad\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "1b1b1171",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.137394Z",
     "iopub.status.busy": "2025-09-14T12:19:55.136426Z",
     "iopub.status.idle": "2025-09-14T12:19:55.160918Z",
     "shell.execute_reply": "2025-09-14T12:19:55.160044Z"
    },
    "papermill": {
     "duration": 0.033385,
     "end_time": "2025-09-14T12:19:55.162626",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.129241",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>season</th>\n",
       "      <th>city</th>\n",
       "      <th>date</th>\n",
       "      <th>match_type</th>\n",
       "      <th>player_of_match</th>\n",
       "      <th>venue</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>toss_winner</th>\n",
       "      <th>...</th>\n",
       "      <th>result</th>\n",
       "      <th>result_margin</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>target_overs</th>\n",
       "      <th>super_over</th>\n",
       "      <th>method</th>\n",
       "      <th>umpire1</th>\n",
       "      <th>umpire2</th>\n",
       "      <th>match_id</th>\n",
       "      <th>total_runs</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>335982</td>\n",
       "      <td>2007/08</td>\n",
       "      <td>Bangalore</td>\n",
       "      <td>2008-04-18</td>\n",
       "      <td>League</td>\n",
       "      <td>BB McCullum</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>...</td>\n",
       "      <td>runs</td>\n",
       "      <td>140.0</td>\n",
       "      <td>223.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Asad Rauf</td>\n",
       "      <td>RE Koertzen</td>\n",
       "      <td>335982</td>\n",
       "      <td>222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>335983</td>\n",
       "      <td>2007/08</td>\n",
       "      <td>Chandigarh</td>\n",
       "      <td>2008-04-19</td>\n",
       "      <td>League</td>\n",
       "      <td>MEK Hussey</td>\n",
       "      <td>Punjab Cricket Association Stadium, Mohali</td>\n",
       "      <td>Punjab Kings</td>\n",
       "      <td>Chennai Super Kings</td>\n",
       "      <td>Chennai Super Kings</td>\n",
       "      <td>...</td>\n",
       "      <td>runs</td>\n",
       "      <td>33.0</td>\n",
       "      <td>241.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MR Benson</td>\n",
       "      <td>SL Shastri</td>\n",
       "      <td>335983</td>\n",
       "      <td>240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>335984</td>\n",
       "      <td>2007/08</td>\n",
       "      <td>Delhi</td>\n",
       "      <td>2008-04-19</td>\n",
       "      <td>League</td>\n",
       "      <td>MF Maharoof</td>\n",
       "      <td>Feroz Shah Kotla</td>\n",
       "      <td>Delhi Capitals</td>\n",
       "      <td>Rajasthan Royals</td>\n",
       "      <td>Rajasthan Royals</td>\n",
       "      <td>...</td>\n",
       "      <td>wickets</td>\n",
       "      <td>9.0</td>\n",
       "      <td>130.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>N</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aleem Dar</td>\n",
       "      <td>GA Pratapkumar</td>\n",
       "      <td>335984</td>\n",
       "      <td>129</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       id   season        city        date match_type player_of_match  \\\n",
       "0  335982  2007/08   Bangalore  2008-04-18     League     BB McCullum   \n",
       "1  335983  2007/08  Chandigarh  2008-04-19     League      MEK Hussey   \n",
       "2  335984  2007/08       Delhi  2008-04-19     League     MF Maharoof   \n",
       "\n",
       "                                        venue                        team1  \\\n",
       "0                       M Chinnaswamy Stadium  Royal Challengers Bengaluru   \n",
       "1  Punjab Cricket Association Stadium, Mohali                 Punjab Kings   \n",
       "2                            Feroz Shah Kotla               Delhi Capitals   \n",
       "\n",
       "                   team2                  toss_winner  ...   result  \\\n",
       "0  Kolkata Knight Riders  Royal Challengers Bangalore  ...     runs   \n",
       "1    Chennai Super Kings          Chennai Super Kings  ...     runs   \n",
       "2       Rajasthan Royals             Rajasthan Royals  ...  wickets   \n",
       "\n",
       "  result_margin target_runs  target_overs  super_over  method    umpire1  \\\n",
       "0         140.0       223.0          20.0           N     NaN  Asad Rauf   \n",
       "1          33.0       241.0          20.0           N     NaN  MR Benson   \n",
       "2           9.0       130.0          20.0           N     NaN  Aleem Dar   \n",
       "\n",
       "          umpire2 match_id total_runs  \n",
       "0     RE Koertzen   335982        222  \n",
       "1      SL Shastri   335983        240  \n",
       "2  GA Pratapkumar   335984        129  \n",
       "\n",
       "[3 rows x 22 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1=df1[df1[\"team1\"].isin(teams)]\n",
    "df1=df1[df1[\"team2\"].isin(teams)]\n",
    "df1.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "d4244590",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.176902Z",
     "iopub.status.busy": "2025-09-14T12:19:55.176605Z",
     "iopub.status.idle": "2025-09-14T12:19:55.182366Z",
     "shell.execute_reply": "2025-09-14T12:19:55.181499Z"
    },
    "papermill": {
     "duration": 0.014696,
     "end_time": "2025-09-14T12:19:55.183926",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.169230",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df1=df1[[\"match_id\",\"venue\",\"winner\",\"target_runs\",\"team1\",\"team2\"]]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d1e0c279",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.198245Z",
     "iopub.status.busy": "2025-09-14T12:19:55.197915Z",
     "iopub.status.idle": "2025-09-14T12:19:55.367997Z",
     "shell.execute_reply": "2025-09-14T12:19:55.366956Z"
    },
    "papermill": {
     "duration": 0.179089,
     "end_time": "2025-09-14T12:19:55.369547",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.190458",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>bowler</th>\n",
       "      <th>non_striker</th>\n",
       "      <th>batsman_runs</th>\n",
       "      <th>extra_runs</th>\n",
       "      <th>total_runs</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>1</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>P Kumar</td>\n",
       "      <td>BB McCullum</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>legbyes</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>1</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>P Kumar</td>\n",
       "      <td>SC Ganguly</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>1</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>P Kumar</td>\n",
       "      <td>SC Ganguly</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>wides</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   match_id                  venue                 winner  target_runs  \\\n",
       "0    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "1    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "2    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "\n",
       "                         team1                  team2  inning  \\\n",
       "0  Royal Challengers Bengaluru  Kolkata Knight Riders       1   \n",
       "1  Royal Challengers Bengaluru  Kolkata Knight Riders       1   \n",
       "2  Royal Challengers Bengaluru  Kolkata Knight Riders       1   \n",
       "\n",
       "            batting_team                 bowling_team  over  ...   bowler  \\\n",
       "0  Kolkata Knight Riders  Royal Challengers Bangalore     0  ...  P Kumar   \n",
       "1  Kolkata Knight Riders  Royal Challengers Bangalore     0  ...  P Kumar   \n",
       "2  Kolkata Knight Riders  Royal Challengers Bangalore     0  ...  P Kumar   \n",
       "\n",
       "   non_striker batsman_runs extra_runs  total_runs  extras_type  is_wicket  \\\n",
       "0  BB McCullum            0          1           1      legbyes          0   \n",
       "1   SC Ganguly            0          0           0          NaN          0   \n",
       "2   SC Ganguly            0          1           1        wides          0   \n",
       "\n",
       "  player_dismissed  dismissal_kind fielder  \n",
       "0              NaN             NaN     NaN  \n",
       "1              NaN             NaN     NaN  \n",
       "2              NaN             NaN     NaN  \n",
       "\n",
       "[3 rows x 22 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df=df1.merge(df,on=\"match_id\")\n",
    "df.head(3)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "219e9442",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.384625Z",
     "iopub.status.busy": "2025-09-14T12:19:55.383969Z",
     "iopub.status.idle": "2025-09-14T12:19:55.416397Z",
     "shell.execute_reply": "2025-09-14T12:19:55.415542Z"
    },
    "papermill": {
     "duration": 0.041639,
     "end_time": "2025-09-14T12:19:55.417899",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.376260",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>bowler</th>\n",
       "      <th>non_striker</th>\n",
       "      <th>batsman_runs</th>\n",
       "      <th>extra_runs</th>\n",
       "      <th>total_runs</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>AB Dinda</td>\n",
       "      <td>W Jaffer</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>AB Dinda</td>\n",
       "      <td>R Dravid</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>wides</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     match_id                  venue                 winner  target_runs  \\\n",
       "124    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "125    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "\n",
       "                           team1                  team2  inning  \\\n",
       "124  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "125  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "\n",
       "                    batting_team           bowling_team  over  ...    bowler  \\\n",
       "124  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...  AB Dinda   \n",
       "125  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...  AB Dinda   \n",
       "\n",
       "    non_striker batsman_runs extra_runs  total_runs  extras_type  is_wicket  \\\n",
       "124    W Jaffer            1          0           1          NaN          0   \n",
       "125    R Dravid            0          1           1        wides          0   \n",
       "\n",
       "    player_dismissed  dismissal_kind fielder  \n",
       "124              NaN             NaN     NaN  \n",
       "125              NaN             NaN     NaN  \n",
       "\n",
       "[2 rows x 22 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df=df[df[\"inning\"]==2]\n",
    "df.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "e5abf729",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.432708Z",
     "iopub.status.busy": "2025-09-14T12:19:55.432409Z",
     "iopub.status.idle": "2025-09-14T12:19:55.444184Z",
     "shell.execute_reply": "2025-09-14T12:19:55.443365Z"
    },
    "papermill": {
     "duration": 0.021154,
     "end_time": "2025-09-14T12:19:55.445856",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.424702",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df[\"total_runs\"] = pd.to_numeric(df[\"total_runs\"], errors=\"coerce\")\n",
    "df[\"cumm_runs\"] = df.groupby(\"match_id\")[\"total_runs\"].cumsum()\n",
    "# df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d0892f91",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.460867Z",
     "iopub.status.busy": "2025-09-14T12:19:55.460542Z",
     "iopub.status.idle": "2025-09-14T12:19:55.655222Z",
     "shell.execute_reply": "2025-09-14T12:19:55.654255Z"
    },
    "papermill": {
     "duration": 0.204127,
     "end_time": "2025-09-14T12:19:55.656924",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.452797",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>batsman_runs</th>\n",
       "      <th>extra_runs</th>\n",
       "      <th>total_runs</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "      <th>cumm_runs</th>\n",
       "      <th>runs_left</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>222.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>wides</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>220.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>128</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4</td>\n",
       "      <td>219.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233896</th>\n",
       "      <td>1426312</td>\n",
       "      <td>MA Chidambaram Stadium, Chepauk, Chennai</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>110</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233897</th>\n",
       "      <td>1426312</td>\n",
       "      <td>MA Chidambaram Stadium, Chepauk, Chennai</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>111</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233898</th>\n",
       "      <td>1426312</td>\n",
       "      <td>MA Chidambaram Stadium, Chepauk, Chennai</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>112</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233899</th>\n",
       "      <td>1426312</td>\n",
       "      <td>MA Chidambaram Stadium, Chepauk, Chennai</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>113</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>233900</th>\n",
       "      <td>1426312</td>\n",
       "      <td>MA Chidambaram Stadium, Chepauk, Chennai</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Sunrisers Hyderabad</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>114</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>112805 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        match_id                                     venue  \\\n",
       "124       335982                     M Chinnaswamy Stadium   \n",
       "125       335982                     M Chinnaswamy Stadium   \n",
       "126       335982                     M Chinnaswamy Stadium   \n",
       "127       335982                     M Chinnaswamy Stadium   \n",
       "128       335982                     M Chinnaswamy Stadium   \n",
       "...          ...                                       ...   \n",
       "233896   1426312  MA Chidambaram Stadium, Chepauk, Chennai   \n",
       "233897   1426312  MA Chidambaram Stadium, Chepauk, Chennai   \n",
       "233898   1426312  MA Chidambaram Stadium, Chepauk, Chennai   \n",
       "233899   1426312  MA Chidambaram Stadium, Chepauk, Chennai   \n",
       "233900   1426312  MA Chidambaram Stadium, Chepauk, Chennai   \n",
       "\n",
       "                       winner  target_runs                        team1  \\\n",
       "124     Kolkata Knight Riders        223.0  Royal Challengers Bengaluru   \n",
       "125     Kolkata Knight Riders        223.0  Royal Challengers Bengaluru   \n",
       "126     Kolkata Knight Riders        223.0  Royal Challengers Bengaluru   \n",
       "127     Kolkata Knight Riders        223.0  Royal Challengers Bengaluru   \n",
       "128     Kolkata Knight Riders        223.0  Royal Challengers Bengaluru   \n",
       "...                       ...          ...                          ...   \n",
       "233896  Kolkata Knight Riders        114.0          Sunrisers Hyderabad   \n",
       "233897  Kolkata Knight Riders        114.0          Sunrisers Hyderabad   \n",
       "233898  Kolkata Knight Riders        114.0          Sunrisers Hyderabad   \n",
       "233899  Kolkata Knight Riders        114.0          Sunrisers Hyderabad   \n",
       "233900  Kolkata Knight Riders        114.0          Sunrisers Hyderabad   \n",
       "\n",
       "                        team2  inning                 batting_team  \\\n",
       "124     Kolkata Knight Riders       2  Royal Challengers Bangalore   \n",
       "125     Kolkata Knight Riders       2  Royal Challengers Bangalore   \n",
       "126     Kolkata Knight Riders       2  Royal Challengers Bangalore   \n",
       "127     Kolkata Knight Riders       2  Royal Challengers Bangalore   \n",
       "128     Kolkata Knight Riders       2  Royal Challengers Bangalore   \n",
       "...                       ...     ...                          ...   \n",
       "233896  Kolkata Knight Riders       2        Kolkata Knight Riders   \n",
       "233897  Kolkata Knight Riders       2        Kolkata Knight Riders   \n",
       "233898  Kolkata Knight Riders       2        Kolkata Knight Riders   \n",
       "233899  Kolkata Knight Riders       2        Kolkata Knight Riders   \n",
       "233900  Kolkata Knight Riders       2        Kolkata Knight Riders   \n",
       "\n",
       "                 bowling_team  over  ...  batsman_runs extra_runs total_runs  \\\n",
       "124     Kolkata Knight Riders     0  ...             1          0          1   \n",
       "125     Kolkata Knight Riders     0  ...             0          1          1   \n",
       "126     Kolkata Knight Riders     0  ...             0          0          0   \n",
       "127     Kolkata Knight Riders     0  ...             1          0          1   \n",
       "128     Kolkata Knight Riders     0  ...             1          0          1   \n",
       "...                       ...   ...  ...           ...        ...        ...   \n",
       "233896    Sunrisers Hyderabad     9  ...             1          0          1   \n",
       "233897    Sunrisers Hyderabad     9  ...             1          0          1   \n",
       "233898    Sunrisers Hyderabad    10  ...             1          0          1   \n",
       "233899    Sunrisers Hyderabad    10  ...             1          0          1   \n",
       "233900    Sunrisers Hyderabad    10  ...             1          0          1   \n",
       "\n",
       "       extras_type  is_wicket  player_dismissed  dismissal_kind fielder  \\\n",
       "124            NaN          0               NaN             NaN     NaN   \n",
       "125          wides          0               NaN             NaN     NaN   \n",
       "126            NaN          0               NaN             NaN     NaN   \n",
       "127            NaN          0               NaN             NaN     NaN   \n",
       "128            NaN          0               NaN             NaN     NaN   \n",
       "...            ...        ...               ...             ...     ...   \n",
       "233896         NaN          0               NaN             NaN     NaN   \n",
       "233897         NaN          0               NaN             NaN     NaN   \n",
       "233898         NaN          0               NaN             NaN     NaN   \n",
       "233899         NaN          0               NaN             NaN     NaN   \n",
       "233900         NaN          0               NaN             NaN     NaN   \n",
       "\n",
       "        cumm_runs runs_left  \n",
       "124             1     222.0  \n",
       "125             2     221.0  \n",
       "126             2     221.0  \n",
       "127             3     220.0  \n",
       "128             4     219.0  \n",
       "...           ...       ...  \n",
       "233896        110       4.0  \n",
       "233897        111       3.0  \n",
       "233898        112       2.0  \n",
       "233899        113       1.0  \n",
       "233900        114       0.0  \n",
       "\n",
       "[112805 rows x 24 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[\"runs_left\"]=df[\"target_runs\"]-df[\"cumm_runs\"]\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "32adf970",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.673013Z",
     "iopub.status.busy": "2025-09-14T12:19:55.672658Z",
     "iopub.status.idle": "2025-09-14T12:19:55.692818Z",
     "shell.execute_reply": "2025-09-14T12:19:55.691889Z"
    },
    "papermill": {
     "duration": 0.029982,
     "end_time": "2025-09-14T12:19:55.694414",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.664432",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>extra_runs</th>\n",
       "      <th>total_runs</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "      <th>cumm_runs</th>\n",
       "      <th>runs_left</th>\n",
       "      <th>balls_left</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>222.0</td>\n",
       "      <td>119</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>wides</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "      <td>118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "      <td>117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>220.0</td>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>128</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4</td>\n",
       "      <td>219.0</td>\n",
       "      <td>115</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     match_id                  venue                 winner  target_runs  \\\n",
       "124    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "125    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "126    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "127    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "128    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "\n",
       "                           team1                  team2  inning  \\\n",
       "124  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "125  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "126  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "127  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "128  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "\n",
       "                    batting_team           bowling_team  over  ...  \\\n",
       "124  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "125  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "126  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "127  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "128  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "\n",
       "     extra_runs total_runs extras_type is_wicket  player_dismissed  \\\n",
       "124           0          1         NaN         0               NaN   \n",
       "125           1          1       wides         0               NaN   \n",
       "126           0          0         NaN         0               NaN   \n",
       "127           0          1         NaN         0               NaN   \n",
       "128           0          1         NaN         0               NaN   \n",
       "\n",
       "     dismissal_kind  fielder cumm_runs  runs_left balls_left  \n",
       "124             NaN      NaN         1      222.0        119  \n",
       "125             NaN      NaN         2      221.0        118  \n",
       "126             NaN      NaN         2      221.0        117  \n",
       "127             NaN      NaN         3      220.0        116  \n",
       "128             NaN      NaN         4      219.0        115  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[\"balls_left\"]=120-df[\"over\"]*6 - df[\"ball\"]\n",
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "4d71aeb4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.711014Z",
     "iopub.status.busy": "2025-09-14T12:19:55.710729Z",
     "iopub.status.idle": "2025-09-14T12:19:55.780227Z",
     "shell.execute_reply": "2025-09-14T12:19:55.779262Z"
    },
    "papermill": {
     "duration": 0.079662,
     "end_time": "2025-09-14T12:19:55.781757",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.702095",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>total_runs</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "      <th>cumm_runs</th>\n",
       "      <th>runs_left</th>\n",
       "      <th>balls_left</th>\n",
       "      <th>wicket_left</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>222.0</td>\n",
       "      <td>119</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     match_id                  venue                 winner  target_runs  \\\n",
       "124    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "\n",
       "                           team1                  team2  inning  \\\n",
       "124  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "\n",
       "                    batting_team           bowling_team  over  ...  \\\n",
       "124  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "\n",
       "     total_runs extras_type is_wicket player_dismissed  dismissal_kind  \\\n",
       "124           1         NaN         0                0             NaN   \n",
       "\n",
       "     fielder  cumm_runs runs_left  balls_left  wicket_left  \n",
       "124      NaN          1     222.0         119           10  \n",
       "\n",
       "[1 rows x 26 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[\"player_dismissed\"] = df[\"player_dismissed\"].fillna(0)\n",
    "df[\"player_dismissed\"] = df[\"player_dismissed\"].apply(lambda x: 0 if x == 0 else 1)\n",
    "df[\"player_dismissed\"] = df[\"player_dismissed\"].astype(int)\n",
    "\n",
    "# Calculate wickets cumulatively per match\n",
    "wickets = df.groupby(\"match_id\")[\"player_dismissed\"].cumsum()\n",
    "\n",
    "# Clip so it never exceeds 10\n",
    "wickets = wickets.clip(upper=10)\n",
    "\n",
    "# Wickets left = 10 - fallen wickets\n",
    "df[\"wicket_left\"] = 10 - wickets\n",
    "\n",
    "df.head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "196cb7ce",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.799169Z",
     "iopub.status.busy": "2025-09-14T12:19:55.798351Z",
     "iopub.status.idle": "2025-09-14T12:19:55.822359Z",
     "shell.execute_reply": "2025-09-14T12:19:55.821522Z"
    },
    "papermill": {
     "duration": 0.034283,
     "end_time": "2025-09-14T12:19:55.823921",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.789638",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>extras_type</th>\n",
       "      <th>is_wicket</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "      <th>cumm_runs</th>\n",
       "      <th>runs_left</th>\n",
       "      <th>balls_left</th>\n",
       "      <th>wicket_left</th>\n",
       "      <th>crr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>222.0</td>\n",
       "      <td>119</td>\n",
       "      <td>10</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>wides</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "      <td>118</td>\n",
       "      <td>10</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "      <td>117</td>\n",
       "      <td>10</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3 rows × 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     match_id                  venue                 winner  target_runs  \\\n",
       "124    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "125    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "126    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "\n",
       "                           team1                  team2  inning  \\\n",
       "124  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "125  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "126  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "\n",
       "                    batting_team           bowling_team  over  ...  \\\n",
       "124  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "125  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "126  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "\n",
       "     extras_type is_wicket player_dismissed dismissal_kind  fielder  \\\n",
       "124          NaN         0                0            NaN      NaN   \n",
       "125        wides         0                0            NaN      NaN   \n",
       "126          NaN         0                0            NaN      NaN   \n",
       "\n",
       "     cumm_runs  runs_left balls_left  wicket_left  crr  \n",
       "124          1      222.0        119           10  6.0  \n",
       "125          2      221.0        118           10  6.0  \n",
       "126          2      221.0        117           10  4.0  \n",
       "\n",
       "[3 rows x 27 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#crr\n",
    "df[\"crr\"]=df[\"cumm_runs\"]*6/(120-df[\"balls_left\"])\n",
    "df.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "e04b2369",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.841018Z",
     "iopub.status.busy": "2025-09-14T12:19:55.840659Z",
     "iopub.status.idle": "2025-09-14T12:19:55.854756Z",
     "shell.execute_reply": "2025-09-14T12:19:55.853867Z"
    },
    "papermill": {
     "duration": 0.024721,
     "end_time": "2025-09-14T12:19:55.856622",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.831901",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "df[\"rrr\"]=df[\"runs_left\"]*6/df[\"balls_left\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "0526ba64",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:55.873990Z",
     "iopub.status.busy": "2025-09-14T12:19:55.873235Z",
     "iopub.status.idle": "2025-09-14T12:19:56.708154Z",
     "shell.execute_reply": "2025-09-14T12:19:56.707257Z"
    },
    "papermill": {
     "duration": 0.844996,
     "end_time": "2025-09-14T12:19:56.709548",
     "exception": false,
     "start_time": "2025-09-14T12:19:55.864552",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>match_id</th>\n",
       "      <th>venue</th>\n",
       "      <th>winner</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>team1</th>\n",
       "      <th>team2</th>\n",
       "      <th>inning</th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>over</th>\n",
       "      <th>...</th>\n",
       "      <th>player_dismissed</th>\n",
       "      <th>dismissal_kind</th>\n",
       "      <th>fielder</th>\n",
       "      <th>cumm_runs</th>\n",
       "      <th>runs_left</th>\n",
       "      <th>balls_left</th>\n",
       "      <th>wicket_left</th>\n",
       "      <th>crr</th>\n",
       "      <th>rrr</th>\n",
       "      <th>result</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>222.0</td>\n",
       "      <td>119</td>\n",
       "      <td>10</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.193277</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>335982</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>223.0</td>\n",
       "      <td>Royal Challengers Bengaluru</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>2</td>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>221.0</td>\n",
       "      <td>118</td>\n",
       "      <td>10</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.237288</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     match_id                  venue                 winner  target_runs  \\\n",
       "124    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "125    335982  M Chinnaswamy Stadium  Kolkata Knight Riders        223.0   \n",
       "\n",
       "                           team1                  team2  inning  \\\n",
       "124  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "125  Royal Challengers Bengaluru  Kolkata Knight Riders       2   \n",
       "\n",
       "                    batting_team           bowling_team  over  ...  \\\n",
       "124  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "125  Royal Challengers Bangalore  Kolkata Knight Riders     0  ...   \n",
       "\n",
       "     player_dismissed dismissal_kind fielder cumm_runs  runs_left  balls_left  \\\n",
       "124                 0            NaN     NaN         1      222.0         119   \n",
       "125                 0            NaN     NaN         2      221.0         118   \n",
       "\n",
       "     wicket_left  crr        rrr  result  \n",
       "124           10  6.0  11.193277       0  \n",
       "125           10  6.0  11.237288       0  \n",
       "\n",
       "[2 rows x 29 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def result(row):\n",
    "    return 1 if row[\"batting_team\"] == row[\"winner\"] else 0\n",
    "\n",
    "df[\"result\"] = df.apply(result, axis=1)\n",
    "df.head(2)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "2169836c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:56.727214Z",
     "iopub.status.busy": "2025-09-14T12:19:56.726924Z",
     "iopub.status.idle": "2025-09-14T12:19:56.736823Z",
     "shell.execute_reply": "2025-09-14T12:19:56.736082Z"
    },
    "papermill": {
     "duration": 0.020824,
     "end_time": "2025-09-14T12:19:56.738425",
     "exception": false,
     "start_time": "2025-09-14T12:19:56.717601",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "final_df=df[[\"batting_team\",\"bowling_team\",\"venue\",\"runs_left\",\"balls_left\",\"wicket_left\",\"target_runs\",\"crr\",\"rrr\",\"result\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "c2da11e3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:56.756410Z",
     "iopub.status.busy": "2025-09-14T12:19:56.755570Z",
     "iopub.status.idle": "2025-09-14T12:19:56.767608Z",
     "shell.execute_reply": "2025-09-14T12:19:56.766800Z"
    },
    "papermill": {
     "duration": 0.022303,
     "end_time": "2025-09-14T12:19:56.768922",
     "exception": false,
     "start_time": "2025-09-14T12:19:56.746619",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>venue</th>\n",
       "      <th>runs_left</th>\n",
       "      <th>balls_left</th>\n",
       "      <th>wicket_left</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>crr</th>\n",
       "      <th>rrr</th>\n",
       "      <th>result</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>222.0</td>\n",
       "      <td>119</td>\n",
       "      <td>10</td>\n",
       "      <td>223.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.193277</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>125</th>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>221.0</td>\n",
       "      <td>118</td>\n",
       "      <td>10</td>\n",
       "      <td>223.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.237288</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>126</th>\n",
       "      <td>Royal Challengers Bangalore</td>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>M Chinnaswamy Stadium</td>\n",
       "      <td>221.0</td>\n",
       "      <td>117</td>\n",
       "      <td>10</td>\n",
       "      <td>223.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>11.333333</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    batting_team           bowling_team  \\\n",
       "124  Royal Challengers Bangalore  Kolkata Knight Riders   \n",
       "125  Royal Challengers Bangalore  Kolkata Knight Riders   \n",
       "126  Royal Challengers Bangalore  Kolkata Knight Riders   \n",
       "\n",
       "                     venue  runs_left  balls_left  wicket_left  target_runs  \\\n",
       "124  M Chinnaswamy Stadium      222.0         119           10        223.0   \n",
       "125  M Chinnaswamy Stadium      221.0         118           10        223.0   \n",
       "126  M Chinnaswamy Stadium      221.0         117           10        223.0   \n",
       "\n",
       "     crr        rrr  result  \n",
       "124  6.0  11.193277       0  \n",
       "125  6.0  11.237288       0  \n",
       "126  4.0  11.333333       0  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.head(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "d88fafed",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:56.787287Z",
     "iopub.status.busy": "2025-09-14T12:19:56.786981Z",
     "iopub.status.idle": "2025-09-14T12:19:56.814761Z",
     "shell.execute_reply": "2025-09-14T12:19:56.813755Z"
    },
    "papermill": {
     "duration": 0.038706,
     "end_time": "2025-09-14T12:19:56.816266",
     "exception": false,
     "start_time": "2025-09-14T12:19:56.777560",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>batting_team</th>\n",
       "      <th>bowling_team</th>\n",
       "      <th>venue</th>\n",
       "      <th>runs_left</th>\n",
       "      <th>balls_left</th>\n",
       "      <th>wicket_left</th>\n",
       "      <th>target_runs</th>\n",
       "      <th>crr</th>\n",
       "      <th>rrr</th>\n",
       "      <th>result</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>126920</th>\n",
       "      <td>Kolkata Knight Riders</td>\n",
       "      <td>Rajasthan Royals</td>\n",
       "      <td>Sawai Mansingh Stadium</td>\n",
       "      <td>59.0</td>\n",
       "      <td>45</td>\n",
       "      <td>7</td>\n",
       "      <td>161.0</td>\n",
       "      <td>8.16</td>\n",
       "      <td>7.866667</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 batting_team      bowling_team                   venue  \\\n",
       "126920  Kolkata Knight Riders  Rajasthan Royals  Sawai Mansingh Stadium   \n",
       "\n",
       "        runs_left  balls_left  wicket_left  target_runs   crr       rrr  \\\n",
       "126920       59.0          45            7        161.0  8.16  7.866667   \n",
       "\n",
       "        result  \n",
       "126920       1  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.sample(final_df.shape[0]).head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "4d08710a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:56.834327Z",
     "iopub.status.busy": "2025-09-14T12:19:56.834006Z",
     "iopub.status.idle": "2025-09-14T12:19:56.861025Z",
     "shell.execute_reply": "2025-09-14T12:19:56.860205Z"
    },
    "papermill": {
     "duration": 0.03776,
     "end_time": "2025-09-14T12:19:56.862552",
     "exception": false,
     "start_time": "2025-09-14T12:19:56.824792",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "batting_team     0\n",
       "bowling_team     0\n",
       "venue            0\n",
       "runs_left        0\n",
       "balls_left       0\n",
       "wicket_left      0\n",
       "target_runs      0\n",
       "crr              0\n",
       "rrr             16\n",
       "result           0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "a44f1a5f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:56.881813Z",
     "iopub.status.busy": "2025-09-14T12:19:56.880773Z",
     "iopub.status.idle": "2025-09-14T12:19:56.935275Z",
     "shell.execute_reply": "2025-09-14T12:19:56.934373Z"
    },
    "papermill": {
     "duration": 0.065922,
     "end_time": "2025-09-14T12:19:56.936850",
     "exception": false,
     "start_time": "2025-09-14T12:19:56.870928",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_13/2274796568.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  final_df.dropna(inplace=True)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "batting_team    0\n",
       "bowling_team    0\n",
       "venue           0\n",
       "runs_left       0\n",
       "balls_left      0\n",
       "wicket_left     0\n",
       "target_runs     0\n",
       "crr             0\n",
       "rrr             0\n",
       "result          0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_df.dropna(inplace=True)\n",
    "final_df.isnull().sum()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "14e993d5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:56.955402Z",
     "iopub.status.busy": "2025-09-14T12:19:56.955047Z",
     "iopub.status.idle": "2025-09-14T12:19:57.279792Z",
     "shell.execute_reply": "2025-09-14T12:19:57.278807Z"
    },
    "papermill": {
     "duration": 0.336184,
     "end_time": "2025-09-14T12:19:57.281565",
     "exception": false,
     "start_time": "2025-09-14T12:19:56.945381",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "x= final_df.iloc[:,:-1]\n",
    "y= final_df.iloc[:,-1]\n",
    "from sklearn.model_selection import train_test_split\n",
    "x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "51abe5c9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:57.301061Z",
     "iopub.status.busy": "2025-09-14T12:19:57.300062Z",
     "iopub.status.idle": "2025-09-14T12:19:57.325737Z",
     "shell.execute_reply": "2025-09-14T12:19:57.324822Z"
    },
    "papermill": {
     "duration": 0.036984,
     "end_time": "2025-09-14T12:19:57.327364",
     "exception": false,
     "start_time": "2025-09-14T12:19:57.290380",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.compose import ColumnTransformer\n",
    "from sklearn.preprocessing import OneHotEncoder\n",
    "trf=ColumnTransformer([\n",
    "    ('trf',OneHotEncoder(sparse=False,drop=\"first\"),[\"batting_team\",\"bowling_team\",\"venue\"])\n",
    "]\n",
    ",remainder=\"passthrough\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "755baa41",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:57.346155Z",
     "iopub.status.busy": "2025-09-14T12:19:57.345815Z",
     "iopub.status.idle": "2025-09-14T12:19:57.736572Z",
     "shell.execute_reply": "2025-09-14T12:19:57.735770Z"
    },
    "papermill": {
     "duration": 0.402192,
     "end_time": "2025-09-14T12:19:57.738277",
     "exception": false,
     "start_time": "2025-09-14T12:19:57.336085",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "\n",
    "pipe = Pipeline(steps=[\n",
    "    ('step1', trf),\n",
    "    ('step2', LogisticRegression(solver=\"liblinear\"))\n",
    "])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "13e5bb68",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:57.756858Z",
     "iopub.status.busy": "2025-09-14T12:19:57.756497Z",
     "iopub.status.idle": "2025-09-14T12:19:57.845969Z",
     "shell.execute_reply": "2025-09-14T12:19:57.845195Z"
    },
    "papermill": {
     "duration": 0.100485,
     "end_time": "2025-09-14T12:19:57.847527",
     "exception": false,
     "start_time": "2025-09-14T12:19:57.747042",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "x_train = x_train.replace([np.inf, -np.inf], np.nan)\n",
    "\n",
    "# Fill NaN with 0 (or you can use mean/median depending on your case)\n",
    "x_train = x_train.fillna(0)\n",
    "\n",
    "# Do the same for x_test to avoid mismatch\n",
    "x_test = x_test.replace([np.inf, -np.inf], np.nan).fillna(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "7ac7edaf",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:57.866532Z",
     "iopub.status.busy": "2025-09-14T12:19:57.866210Z",
     "iopub.status.idle": "2025-09-14T12:19:59.809270Z",
     "shell.execute_reply": "2025-09-14T12:19:59.808439Z"
    },
    "papermill": {
     "duration": 1.954686,
     "end_time": "2025-09-14T12:19:59.810878",
     "exception": false,
     "start_time": "2025-09-14T12:19:57.856192",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/local/lib/python3.11/dist-packages/sklearn/preprocessing/_encoders.py:868: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Pipeline(steps=[(&#x27;step1&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;trf&#x27;,\n",
       "                                                  OneHotEncoder(drop=&#x27;first&#x27;,\n",
       "                                                                sparse=False),\n",
       "                                                  [&#x27;batting_team&#x27;,\n",
       "                                                   &#x27;bowling_team&#x27;,\n",
       "                                                   &#x27;venue&#x27;])])),\n",
       "                (&#x27;step2&#x27;, LogisticRegression(solver=&#x27;liblinear&#x27;))])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Pipeline</label><div class=\"sk-toggleable__content\"><pre>Pipeline(steps=[(&#x27;step1&#x27;,\n",
       "                 ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                                   transformers=[(&#x27;trf&#x27;,\n",
       "                                                  OneHotEncoder(drop=&#x27;first&#x27;,\n",
       "                                                                sparse=False),\n",
       "                                                  [&#x27;batting_team&#x27;,\n",
       "                                                   &#x27;bowling_team&#x27;,\n",
       "                                                   &#x27;venue&#x27;])])),\n",
       "                (&#x27;step2&#x27;, LogisticRegression(solver=&#x27;liblinear&#x27;))])</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">step1: ColumnTransformer</label><div class=\"sk-toggleable__content\"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,\n",
       "                  transformers=[(&#x27;trf&#x27;,\n",
       "                                 OneHotEncoder(drop=&#x27;first&#x27;, sparse=False),\n",
       "                                 [&#x27;batting_team&#x27;, &#x27;bowling_team&#x27;, &#x27;venue&#x27;])])</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">trf</label><div class=\"sk-toggleable__content\"><pre>[&#x27;batting_team&#x27;, &#x27;bowling_team&#x27;, &#x27;venue&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">OneHotEncoder</label><div class=\"sk-toggleable__content\"><pre>OneHotEncoder(drop=&#x27;first&#x27;, sparse=False)</pre></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">remainder</label><div class=\"sk-toggleable__content\"><pre>[&#x27;runs_left&#x27;, &#x27;balls_left&#x27;, &#x27;wicket_left&#x27;, &#x27;target_runs&#x27;, &#x27;crr&#x27;, &#x27;rrr&#x27;]</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" ><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">passthrough</label><div class=\"sk-toggleable__content\"><pre>passthrough</pre></div></div></div></div></div></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" ><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression(solver=&#x27;liblinear&#x27;)</pre></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "Pipeline(steps=[('step1',\n",
       "                 ColumnTransformer(remainder='passthrough',\n",
       "                                   transformers=[('trf',\n",
       "                                                  OneHotEncoder(drop='first',\n",
       "                                                                sparse=False),\n",
       "                                                  ['batting_team',\n",
       "                                                   'bowling_team',\n",
       "                                                   'venue'])])),\n",
       "                ('step2', LogisticRegression(solver='liblinear'))])"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pipe.fit(x_train,y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "a716ef02",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:59.829823Z",
     "iopub.status.busy": "2025-09-14T12:19:59.829540Z",
     "iopub.status.idle": "2025-09-14T12:19:59.879546Z",
     "shell.execute_reply": "2025-09-14T12:19:59.878721Z"
    },
    "papermill": {
     "duration": 0.061374,
     "end_time": "2025-09-14T12:19:59.881254",
     "exception": false,
     "start_time": "2025-09-14T12:19:59.819880",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "y_pred=pipe.predict(x_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "a1d66827",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:59.901714Z",
     "iopub.status.busy": "2025-09-14T12:19:59.901389Z",
     "iopub.status.idle": "2025-09-14T12:19:59.910210Z",
     "shell.execute_reply": "2025-09-14T12:19:59.909268Z"
    },
    "papermill": {
     "duration": 0.021186,
     "end_time": "2025-09-14T12:19:59.911872",
     "exception": false,
     "start_time": "2025-09-14T12:19:59.890686",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8082276797588439"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.metrics import accuracy_score\n",
    "accuracy_score(y_test,y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "c1b68373",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-09-14T12:19:59.997147Z",
     "iopub.status.busy": "2025-09-14T12:19:59.996838Z",
     "iopub.status.idle": "2025-09-14T12:20:00.005067Z",
     "shell.execute_reply": "2025-09-14T12:20:00.004256Z"
    },
    "papermill": {
     "duration": 0.085353,
     "end_time": "2025-09-14T12:20:00.006508",
     "exception": false,
     "start_time": "2025-09-14T12:19:59.921155",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['my_model.pkl']"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import joblib\n",
    "\n",
    "# Save the trained pipeline\n",
    "joblib.dump(pipe, \"my_model.pkl\")\n",
    "\n",
    "# Later (for loading)\n",
    "# pipe = joblib.load(\"my_model.pkl\")\n"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 990900,
     "sourceId": 8637500,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31089,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 16.199003,
   "end_time": "2025-09-14T12:20:00.737062",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-09-14T12:19:44.538059",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
